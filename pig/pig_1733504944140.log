Error before Pig is launched
----------------------------
ERROR 2997: Encountered IOException. Embedded script cannot mix UDFs with top level code. Please use if __name__ == '__main__': construct

java.io.IOException: Embedded script cannot mix UDFs with top level code. Please use if __name__ == '__main__': construct
	at org.apache.pig.scripting.jython.JythonScriptEngine.hasFunction(JythonScriptEngine.java:485)
	at org.apache.pig.scripting.jython.JythonScriptEngine.main(JythonScriptEngine.java:414)
	at org.apache.pig.scripting.ScriptEngine.run(ScriptEngine.java:310)
	at org.apache.pig.Main.runEmbeddedScript(Main.java:1081)
	at org.apache.pig.Main.run(Main.java:586)
	at org.apache.pig.Main.main(Main.java:178)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:318)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:232)
================================================================================
